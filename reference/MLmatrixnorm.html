<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Maximum likelihood estimation for matrix normal distributions — MLmatrixnorm • MixMatrix</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum likelihood estimation for matrix normal distributions — MLmatrixnorm"><meta property="og:description" content="Maximum likelihood estimates exist for \(N &amp;gt; max(p/q,q/p)+1\) and are
unique for \(N &amp;gt; max(p,q)\). This finds the estimate for the mean and then
alternates between estimates for the \(U\) and \(V\) matrices until
convergence. An AR(1), compound symmetry, correlation matrix, or independence
restriction can be proposed for either or both variance matrices. However, if
they are inappropriate for the data, they may fail with a warning."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
    <li>
      <a href="../articles/mixturemodel.html">Matrix Variate Mixture Models with the t distribution</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/gzt/MixMatrix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Maximum likelihood estimation for matrix normal distributions</h1>
    <small class="dont-index">Source: <a href="https://github.com/gzt/MixMatrix/blob/master/R/matrixnorm.R" class="external-link"><code>R/matrixnorm.R</code></a></small>
    <div class="hidden name"><code>MLmatrixnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Maximum likelihood estimates exist for \(N &gt; max(p/q,q/p)+1\) and are
unique for \(N &gt; max(p,q)\). This finds the estimate for the mean and then
alternates between estimates for the \(U\) and \(V\) matrices until
convergence. An AR(1), compound symmetry, correlation matrix, or independence
restriction can be proposed for either or both variance matrices. However, if
they are inappropriate for the data, they may fail with a warning.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">MLmatrixnorm</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  row.mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  col.mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  row.variance <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  col.variance <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">10</span> <span class="op">*</span> <span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span><span class="op">^</span><span class="fl">0.5</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">U</span>,</span>
<span>  <span class="va">V</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Either a list of matrices or a 3-D array with matrices in
dimensions 1 and 2, indexed by dimension 3.</p></dd>


<dt id="arg-row-mean">row.mean<a class="anchor" aria-label="anchor" href="#arg-row-mean"></a></dt>
<dd><p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>col.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p></dd>


<dt id="arg-col-mean">col.mean<a class="anchor" aria-label="anchor" href="#arg-col-mean"></a></dt>
<dd><p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>row.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p></dd>


<dt id="arg-row-variance">row.variance<a class="anchor" aria-label="anchor" href="#arg-row-variance"></a></dt>
<dd><p>Imposes a variance structure on the rows. Either
'none', 'AR(1)', 'CS' for 'compound symmetry', 'Correlation' for a
correlation matrix, or 'Independence' for
independent and identical variance across the rows.
Only positive correlations are allowed for AR(1) and CS covariances.
Note that while maximum likelihood estimators are available (and used) for
the unconstrained variance matrices, <code>optim</code> is used for any
constraints so it may be considerably slower.</p></dd>


<dt id="arg-col-variance">col.variance<a class="anchor" aria-label="anchor" href="#arg-col-variance"></a></dt>
<dd><p>Imposes a variance structure on the columns.
Either 'none', 'AR(1)', 'CS', 'Correlation', or 'Independence'.
Only positive correlations are allowed for
AR(1) and CS.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Convergence criterion. Measured against square deviation
between iterations of the two variance-covariance matrices.</p></dd>


<dt id="arg-max-iter">max.iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Maximum possible iterations of the algorithm.</p></dd>


<dt id="arg-u">U<a class="anchor" aria-label="anchor" href="#arg-u"></a></dt>
<dd><p>(optional) Can provide a starting point for the <code>U</code> matrix.
By default, an identity matrix.</p></dd>


<dt id="arg-v">V<a class="anchor" aria-label="anchor" href="#arg-v"></a></dt>
<dd><p>(optional) Can provide a starting point for the <code>V</code> matrix.
By default, an identity matrix.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(optional) additional arguments can be passed to <code>optim</code>
if using restrictions on the variance.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a list with a the following elements:</p><dl><dt><code>mean</code></dt>
<dd><p>the mean matrix</p></dd>

<dt><code>scaling</code></dt>
<dd><p>the scalar variance parameter
(the first entry of the covariances are restricted to unity)</p></dd>

<dt><code>U</code></dt>
<dd><p>the between-row covariance matrix</p></dd>

<dt><code>V</code></dt>
<dd><p>the between-column covariance matrix</p></dd>

<dt><code>iter</code></dt>
<dd><p>the number of iterations</p></dd>

<dt><code>tol</code></dt>
<dd><p>the squared difference between iterations of
the variance matrices at the time of stopping</p></dd>

<dt><code>logLik</code></dt>
<dd><p>vector of log likelihoods at each iteration.</p></dd>

<dt><code>convergence</code></dt>
<dd><p>a convergence flag, <code>TRUE</code> if converged.</p></dd>

<dt><code>call</code></dt>
<dd><p>The (matched) function call.</p></dd>


</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Pierre Dutilleul.  The MLE algorithm for the matrix normal
distribution.
Journal of Statistical Computation and Simulation, (64):105–123, 1999.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>Gupta, Arjun K, and Daya K Nagar. <span class="fl">1999.</span> Matrix Variate Distributions.</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>Vol. <span class="fl">104.</span> CRC Press. ISBN<span class="sc">:</span><span class="dv">978-1584880462</span></span></code></pre><p></p></div>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="rmatrixnorm.html">rmatrixnorm()</a></code> and <code><a href="MLmatrixt.html">MLmatrixt()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180202</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># simulating from a given density</span></span></span>
<span class="r-in"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">100</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">100</span>, <span class="fl">0</span>, <span class="fl">25</span>, <span class="op">-</span><span class="fl">1000</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">.1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, list <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># finding the parameters by ML estimation</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">MLmatrixnorm</span><span class="op">(</span><span class="va">A</span>, tol <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]         [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 99.7692446 -100.2587675   25.0921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.1010964   -0.1537989 -999.9448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $U</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.0000000 0.5011833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5011833 0.2542832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $V</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]         [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.000000000  0.08886106  0.003307394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.088861062  0.99216709 -0.048960829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.003307394 -0.04896083  0.808693751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.984761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iter</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.599358e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $logLik</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -415.1583 -376.4587 -376.4574 -376.4574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $call</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MLmatrixnorm(data = A, tol = 1e-05)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

