<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Maximum likelihood estimation for matrix variate t distributions — MLmatrixt • MixMatrix</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Maximum likelihood estimation for matrix variate t distributions — MLmatrixt" />
<meta property="og:description" content="For the matrix variate normal distribution, maximum likelihood estimates
exist for \(N &amp;gt; max(p/q,q/p)+1\) and are unique for \(N &amp;gt; max(p,q)\).
The number necessary for the matrix variate t has not been worked out but
this is a lower bound. This implements an ECME algorithm to estimate the
mean, covariance, and degrees of freedom parameters. An AR(1), compound
symmetry, or independence restriction can be proposed for either or both
variance matrices. However, if they are inappropriate for the data, they may
fail with a warning." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
    <li>
      <a href="../articles/mixturemodel.html">Matrix Variate Mixture Models with the t distribution</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/gzt/MixMatrix">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Maximum likelihood estimation for matrix variate t distributions</h1>
    <small class="dont-index">Source: <a href='https://github.com/gzt/MixMatrix/blob/master/R/mlmatrixt.R'><code>R/mlmatrixt.R</code></a></small>
    <div class="hidden name"><code>MLmatrixt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For the matrix variate normal distribution, maximum likelihood estimates
exist for \(N &gt; max(p/q,q/p)+1\) and are unique for \(N &gt; max(p,q)\).
The number necessary for the matrix variate t has not been worked out but
this is a lower bound. This implements an ECME algorithm to estimate the
mean, covariance, and degrees of freedom parameters. An AR(1), compound
symmetry, or independence restriction can be proposed for either or both
variance matrices. However, if they are inappropriate for the data, they may
fail with a warning.</p>
    </div>

    <pre class="usage"><span class='fu'>MLmatrixt</span>(<span class='no'>data</span>, <span class='kw'>row.mean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>col.mean</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>row.variance</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>col.variance</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>fixed</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='no'>.Machine</span>$<span class='no'>double.eps</span>^<span class='fl'>0.5</span>, <span class='kw'>max.iter</span> <span class='kw'>=</span> <span class='fl'>5000</span>, <span class='no'>U</span>, <span class='no'>V</span>,
  <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>Either a list of matrices or a 3-D array with matrices in
dimensions 1 and 2, indexed by dimension 3.</p></td>
    </tr>
    <tr>
      <th>row.mean</th>
      <td><p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>col.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p></td>
    </tr>
    <tr>
      <th>col.mean</th>
      <td><p>By default, <code>FALSE</code>. If <code>TRUE</code>, will fit a
common mean within each row. If both this and <code>row.mean</code> are
<code>TRUE</code>, there will be a common mean for the entire matrix.</p></td>
    </tr>
    <tr>
      <th>row.variance</th>
      <td><p>Imposes a variance structure on the rows. Either
'none', 'AR(1)', 'CS' for 'compound symmetry', 'Correlation' for a
correlation matrix, or 'Independence' for
independent and identical variance across the rows.
Only positive correlations are allowed for AR(1) and CS.
Note that while maximum likelihood estimators are available (and used)
for the unconstrained variance matrices, <code>optim</code> is used for any
constraints so it may be considerably slower.</p></td>
    </tr>
    <tr>
      <th>col.variance</th>
      <td><p>Imposes a variance structure on the columns.
Either 'none', 'AR(1)', 'CS', 'Correlation', or 'Independence'.
Only positive correlations are allowed for
AR(1) and CS.</p></td>
    </tr>
    <tr>
      <th>df</th>
      <td><p>Starting value for the degrees of freedom. If <code>fixed = TRUE</code>,
then this is required and not updated. By default, set to 10.</p></td>
    </tr>
    <tr>
      <th>fixed</th>
      <td><p>Whether <code>df</code> is estimated or fixed. By default, <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>Convergence criterion. Measured against square deviation
between iterations of the two variance-covariance matrices.</p></td>
    </tr>
    <tr>
      <th>max.iter</th>
      <td><p>Maximum possible iterations of the algorithm.</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p>(optional) Can provide a starting point for the U matrix.
By default, an identity matrix.</p></td>
    </tr>
    <tr>
      <th>V</th>
      <td><p>(optional) Can provide a starting point for the V matrix.
By default, an identity matrix.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(optional) additional arguments can be passed to <code>optim</code>
if using restrictions on the variance.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list with the following elements:</p><dl class='dl-horizontal'>
      <dt><code>mean</code></dt><dd><p>the mean matrix</p></dd>
      <dt><code>U</code></dt><dd><p>the between-row covariance matrix</p></dd>
      <dt><code>V</code></dt><dd><p>the between-column covariance matrix</p></dd>
      <dt><code>var</code></dt><dd><p>the scalar variance parameter
           (the first entry of the covariances are restricted to unity)</p></dd>
      <dt><code>nu</code></dt><dd><p>the degrees of freedom parameter</p></dd>
      <dt><code>iter</code></dt><dd><p>the number of iterations</p></dd>
      <dt><code>tol</code></dt><dd><p>the squared difference between iterations of
           the variance matrices at the time of stopping</p></dd>
      <dt><code>logLik</code></dt><dd><p>log likelihood of result.</p></dd>
      <dt><code>convergence</code></dt><dd><p>a convergence flag, <code>TRUE</code> if converged.</p></dd>
      <dt><code>call</code></dt><dd><p>The (matched) function call.</p></dd>
   
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Thompson, G Z.  R Maitra, W Q Meeker, A Bastawros (2019),
    "Classification with the matrix-variate-t distribution", arXiv
    e-prints arXiv:1907.09565 <a href='https://arxiv.org/abs/1907.09565'>https://arxiv.org/abs/1907.09565</a></p>
<p>Dickey, James M. 1967. “Matricvariate Generalizations of the Multivariate t
       Distribution and the Inverted Multivariate t
       Distribution.” Ann. Math. Statist. 38 (2): 511–18. doi: <a href='https://doi.org/10.1214/aoms/1177698967'>10.1214/aoms/1177698967</a></p>
<p>Liu, Chuanhai, and Donald B. Rubin. 1994. “The ECME Algorithm: A Simple Extension of
          EM and ECM with Faster Monotone Convergence.” Biometrika 81 (4): 633–48.
          doi: <a href='https://doi.org/10.2307/2337067'>10.2307/2337067</a></p>
<p>Meng, Xiao-Li, and Donald B. Rubin. 1993. “Maximum Likelihood Estimation via the ECM
            Algorithm: A General Framework.” Biometrika 80 (2): 267–78.
            doi: <a href='https://doi.org/10.1093/biomet/80.2.267'>10.1093/biomet/80.2.267</a></p>
<p>Rubin, D.B. 1983. “Encyclopedia of Statistical Sciences.” In, 4th ed., 272–5. John Wiley.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='rmatrixnorm.html'>rmatrixnorm</a></code>, <code><a href='rmatrixt.html'>rmatrixt</a></code>, <code><a href='MLmatrixnorm.html'>MLmatrixnorm</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>20180202</span>)
<span class='co'># drawing from a distribution with specified mean and covariance</span>
<span class='no'>A</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rmatrixt.html'>rmatrixt</a></span>(<span class='kw'>n</span><span class='kw'>=</span><span class='fl'>100</span>,<span class='kw'>mean</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>100</span>,<span class='fl'>0</span>,-<span class='fl'>100</span>,<span class='fl'>0</span>,<span class='fl'>25</span>,-<span class='fl'>1000</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),
   <span class='kw'>L</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>0</span>,<span class='fl'>.1</span>),<span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>2</span>),<span class='kw'>list</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>5</span>)
<span class='co'># fitting maximum likelihood estimates</span>
<span class='no'>results</span><span class='kw'>=</span><span class='fu'>MLmatrixt</span>(<span class='no'>A</span>, <span class='kw'>tol</span> <span class='kw'>=</span> <span class='fl'>1e-5</span>, <span class='kw'>df</span> <span class='kw'>=</span> <span class='fl'>5</span>)
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>results</span>)</div><div class='output co'>#&gt; $mean
#&gt;             [,1]          [,2]        [,3]
#&gt; [1,] 99.86681274 -100.08579303    24.96235
#&gt; [2,] -0.05923668   -0.05035992 -1000.01499
#&gt; 
#&gt; $U
#&gt;           [,1]      [,2]
#&gt; [1,] 1.0000000 0.5053587
#&gt; [2,] 0.5053587 0.2585040
#&gt; 
#&gt; $V
#&gt;             [,1]       [,2]        [,3]
#&gt; [1,]  1.00000000  0.1299735 -0.06949657
#&gt; [2,]  0.12997346  1.1392257 -0.07063750
#&gt; [3,] -0.06949657 -0.0706375  0.87998084
#&gt; 
#&gt; $var
#&gt; [1] 3.666694
#&gt; 
#&gt; $nu
#&gt; [1] 5
#&gt; 
#&gt; $iter
#&gt; [1] 30
#&gt; 
#&gt; $tol
#&gt; [1] 8.100888e-06
#&gt; 
#&gt; $logLik
#&gt; [1] 3.492195
#&gt; 
#&gt; $convergence
#&gt; [1] TRUE
#&gt; 
#&gt; $call
#&gt; MLmatrixt(data = A, df = 5, tol = 1e-05)
#&gt; </div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


