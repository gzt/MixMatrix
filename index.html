<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classification with Matrix Variate Normal and t Distributions â€¢ MixMatrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Classification with Matrix Variate Normal and t Distributions">
<meta property="og:description" content="Provides sampling and density functions for matrix
    variate normal, t, and inverted t distributions;  ML estimation for matrix
    variate normal and t distributions using the EM algorithm,
    including some restrictions on the parameters; and classification by linear and
    quadratic discriminant analysis for matrix variate normal and t
    distributions described in Thompson et al. (2019) &lt;doi:10.1080/10618600.2019.1696208&gt;.
    Performs clustering with matrix variate normal and t mixture models.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
    <li>
      <a href="articles/mixturemodel.html">Matrix Variate Mixture Models with the t distribution</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/MixMatrix/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="mixmatrix" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#mixmatrix" class="anchor"></a>MixMatrix</h1></div>
<p>Provides sampling and density functions for matrix variate normal, <em>t</em>, and inverted <em>t</em> distributions; ML estimation<br>
using the EM algorithm for matrix variate normal and <em>t</em> distributions including some restrictions on the parameters; and classification by linear and quadratic discriminant analysis for matrix variate normal and <em>t</em> distributions. Performs clustering with matrix variate normal and <em>t</em> mixture models.</p>
<p>See the vignettes for an example of how it works.</p>
<p>It is currently possible to constrain the mean matrices for normal and <em>t</em> distributed matrices to have a common mean across rows, columns, or both, as well as AR(1), compound symmetric, on identity covariance matrices across rows, columns, or both in the maximum likelihood estimation functions and the LDA and QDA functions. In the mixture model function, it is possible to have a common mean within groups across rows, columns, or both.</p>
<p>There are some other R packages you may be interested in if you are working with matrix-variate distributions. The excellent <a href="https://cran.r-project.org/package=matrixsampling">matrixsampling</a> package has sampling and distribution functions for these and many other matrix distributions, as does <a href="https://cran.r-project.org/package=LaplacesDemon">LaplacesDemon</a>. The <a href="https://cran.r-project.org/package=MatrixLDA">MatrixLDA</a> package performs LDA for normal distributions with penalized likelihood.</p>
<p>Install from CRAN by running:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">'MixMatrix'</span>)</span></code></pre></div>
<p>The development version of the software can be installed by running:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"gzt/MixMatrix"</span>)</span></code></pre></div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>The various <code>r*</code> and <code>d*</code> functions return or take as input an array indexed by the third dimension.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>meanmatrix =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>A =<span class="st"> </span><span class="kw">rmatrixnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mean =</span> meanmatrix, <span class="dt">U =</span> <span class="kw">diag</span>(<span class="dv">3</span>), <span class="dt">V =</span> <span class="kw">diag</span>(<span class="dv">4</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a>A[,,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">dmatrixnorm</span>(A, <span class="dt">mean =</span> meanmatrix, <span class="dt">U =</span> <span class="kw">diag</span>(<span class="dv">3</span>), <span class="dt">V =</span> <span class="kw">diag</span>(<span class="dv">4</span>), <span class="dt">log =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>The package presents a method of maximum likelihood estimation of the parameters of the matrix variate <em>t</em> distribution using ECME.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>X =<span class="st"> </span><span class="kw">rmatrixt</span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">mean =</span> meanmatrix, <span class="dt">U =</span> <span class="kw">diag</span>(<span class="dv">3</span>), <span class="dt">V =</span> <span class="kw">diag</span>(<span class="dv">4</span>), <span class="dt">df =</span> <span class="dv">10</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">MLmatrixt</span>(X, <span class="dt">fixed =</span> <span class="ot">FALSE</span>) <span class="co"># fixed = FALSE indicates to estimate the DF parameter</span></span></code></pre></div>
<p>Because it might be useful in conjunction with the <code>r*</code> and <code>d*</code> functions, the package also includes some convenience functions for generating AR(1) and compound symmetry correlation matrices.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">ARgenerate</span>(<span class="dv">5</span>, <span class="fl">.5</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">CSgenerate</span>(<span class="dv">5</span>, <span class="fl">.5</span>)</span></code></pre></div>
<p>The package also presents linear discriminant analysis and quadratic discriminant analysis for matrix variate distributions in the case of the normal and the <em>t</em>-distribution. In the case of the <em>t</em>, linear and quadratic refer whether the covariance matrices are constrained to be the same between classes rather than the form of the classifier.</p>
<pre><code> A &lt;- rmatrixnorm(30,mean=matrix(0,nrow=3,ncol=4))
 B &lt;- rmatrixnorm(30,mean=matrix(1,nrow=3,ncol=4), U = 2 * ARgenerate(3, .8))
 C &lt;- array(c(A,B), dim=c(3,4,60))
 groups &lt;- c(rep(1,30),rep(2,30))
 prior &lt;- c(.5,.5)
 D &lt;- matrixqda(C, groups, prior)
 predict(D)$posterior[1:10,]</code></pre>
<p>In the future, this will include a more comprehensive treatment of matrix variate mixture modeling, including complete specification of covariance matrices in mixture modeling after the style of <a href="https://cran.r-project.org/package=mclust">Mclust</a>, <a href="https://cran.r-project.org/package=teigen">t-Eigen</a>, and other similar work.</p>
<pre><code>    ### set two different matrix variate populations and combine into one array
 A &lt;- rmatrixnorm(30,mean=matrix(0,nrow=3,ncol=4))
 B &lt;- rmatrixnorm(30,mean=matrix(1,nrow=3,ncol=4), U = 2 * ARgenerate(3, .8))
 C &lt;- array(c(A,B), dim=c(3,4,60))
 groups &lt;- c(rep(1,30),rep(2,30))
 prior &lt;- c(.5,.5)
    ### set up the mixture model
 D &lt;- matrixmixture(C, prior, row.mean = TRUE, tolerance = 1e-2)
    ### print the results, the final mixing proportion, the log-likelihood,
    ### the BIC, and a plot of the log-likelihood.
 print(D$centers) # the final centers
 print(D$pi) # the final mixing proportion
 logLik(D)
 BIC(logLik(D))
 plot(D) # the log likelihood by iteration</code></pre>
</div>
<div id="contribution-and-contact-information" class="section level2">
<h2 class="hasAnchor">
<a href="#contribution-and-contact-information" class="anchor"></a>Contribution and contact information</h2>
<p>Please let me know if you have any issues or suggestions here: <a href="https://github.com/gzt/MixMatrix/issues" class="uri">https://github.com/gzt/MixMatrix/issues</a></p>
<p>Please note that the <code>MixMatrix</code> project is released with a <a href="https://gzt.github.io/MixMatrix/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=MixMatrix">https://â€‹cloud.r-project.org/â€‹package=MixMatrix</a>
</li>
<li>Browse source code at <br><a href="https://github.com/gzt/MixMatrix/">https://â€‹github.com/â€‹gzt/â€‹MixMatrix/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/gzt/MixMatrix/issues">https://â€‹github.com/â€‹gzt/â€‹MixMatrix/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Geoffrey Thompson <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2436-8822" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/gzt/MixMatrix/actions"><img src="https://github.com/gzt/MixMatrix/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://travis-ci.org/gzt/MixMatrix"><img src="https://travis-ci.org/gzt/MixMatrix.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://ci.appveyor.com/project/gzt/MixMatrix"><img src="https://ci.appveyor.com/api/projects/status/github/gzt/MixMatrix?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a></li>
<li><a href="https://codecov.io/github/gzt/MixMatrix?branch=master"><img src="https://img.shields.io/codecov/c/github/gzt/MixMatrix/master.svg" alt="Coverage Status"></a></li>
<li><a href="https://github.com/gzt/MixMatrix/releases"><img src="https://img.shields.io/badge/Package%20version-0.2.6%20-orange.svg?style=flat-square" alt="packageversion"></a></li>
<li><a href="https://github.com/gzt/MixMatrix/"><img src="http://www.r-pkg.org/badges/version/MixMatrix" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=MixMatrix"><img src="https://cranlogs.r-pkg.org/badges/MixMatrix"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
