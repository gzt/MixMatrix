<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matrix Variate Mixture Models with the t distribution • MixMatrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Matrix Variate Mixture Models with the t distribution">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
    <li>
      <a href="../articles/mixturemodel.html">Matrix Variate Mixture Models with the t distribution</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/MixMatrix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Matrix Variate Mixture Models with the t
distribution</h1>
                        <h4 data-toc-skip class="author">Geoffrey
Thompson</h4>
            
            <h4 data-toc-skip class="date">2024-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gzt/MixMatrix/blob/master/vignettes/mixturemodel.Rmd" class="external-link"><code>vignettes/mixturemodel.Rmd</code></a></small>
      <div class="hidden name"><code>mixturemodel.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gzt/MixMatrix/" class="external-link">MixMatrix</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="matrix-variate-mixture-modeling-with-the-t-distribution">Matrix Variate Mixture Modeling with the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
Distribution<a class="anchor" aria-label="anchor" href="#matrix-variate-mixture-modeling-with-the-t-distribution"></a>
</h2>
<p>The matrix variate <em>t</em> distribution was introduced in a
previous vignette along with an EM algorithm for maximum likelihood
fitting of the parameters. This can be extended rather easily to the
case of mixture models for model-based clustering.</p>
<p>As in the case of mixture modeling in general <span class="citation">(<a href="#ref-fraley2002model">Fraley and Raftery
2002</a>; <a href="#ref-mclachlan2019finite">McLachlan, Lee, and
Rathnayake 2019</a>)</span>, the difference in the EM algorithm is that
one is now including estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\pi_{j}</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">1,2, \ldots, g</annotation></semantics></math>,
the estimated probabilities of group membership for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>g</mi><annotation encoding="application/x-tex">g</annotation></semantics></math>
groups in each step and weights
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{ij}</annotation></semantics></math>,
weights for each observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and group
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>,
where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>j</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\pi_j = \frac{1}{n}\sum_{i = 1}^n \tau_{ij}</annotation></semantics></math>
and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mi>j</mi></msub><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Θ</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>g</mi></munderover><msub><mi>π</mi><mi>l</mi></msub><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>,</mo><msub><mi>Θ</mi><mi>l</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \tau_{ij} = \frac{\pi_j f(x_i, \Theta_j)}{\sum_{l=1}^g \pi_l f(x_i, \Theta_l)}</annotation></semantics></math></p>
<p>The case of the matrix variate normal distribution can be seen in
<span class="citation">Viroli (<a href="#ref-viroliclass2011">2011</a>)</span>, while the case of the
multivariate <em>t</em> can be seen in <span class="citation">Andrews,
McNicholas, and Subedi (<a href="#ref-ANDREWS2011520">2011</a>)</span>.</p>
<p>The updates on the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Θ</mi><annotation encoding="application/x-tex">\Theta</annotation></semantics></math>
are weighted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{ij}</annotation></semantics></math>
in an Expectation/Conditional Maximization algorithm.</p>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The <code><a href="../reference/matrixmixture.html">matrixmixture()</a></code> function fits unrestricted
covariance matrices currently, but future features will implement a <a href="https://cran.r-project.org/package=teigen" class="external-link"><code>teigen</code></a>
type of covariance restriction capability for use with the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distribution. It can set means to be constant along rows or columns or
both using the <code>row.mean = TRUE</code> and
<code>col.mean = TRUE</code> settings.</p>
<p>Currently, this can perform model fitting with unrestricted
covariance matrices and fixed degrees of freedom (<code>nu</code>)
parameter or for the matrix normal distribution. It does not solve the
identifiability problem, that is, that permutations of the labels will
yield identical solutions.</p>
<div class="section level3">
<h3 id="matrixmixture-function">
<code>matrixmixture</code> function<a class="anchor" aria-label="anchor" href="#matrixmixture-function"></a>
</h3>
<p>The function takes data array <code>x</code>, either an argument
<code>K</code> for how many groups there are or an initialization of a
vector of probabilities <code>prior</code>, an optional initialization
of centers and covariance matrices <code>init</code> (if the covariances
are left blank, they will be initialized to identity matrices), and
optional arguments controlling the other parameters of function, such as
number of iterations and normal vs <em>t</em>. If
<code>model = "t"</code> is chosen, the degrees of freedom
<code>nu</code> must be provided, but in the future it can be
estimated.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gzt/MixMatrix/" class="external-link">MixMatrix</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180221</span><span class="op">)</span></span>
<span> <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">3</span>,ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># 3x4 matrices with mean 0</span></span>
<span> <span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">3</span>,ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># 3x4 matrices with mean 2</span></span>
<span> <span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span> <span class="co"># combine into one array</span></span>
<span> <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span> <span class="co"># equal probability prior</span></span>
<span> <span class="co"># create an intialization object, starts at the true parameters</span></span>
<span> <span class="va">init</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span> <span class="co"># fit model</span></span>
<span> <span class="va">res</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/matrixmixture.html">matrixmixture</a></span><span class="op">(</span><span class="va">C</span>, init <span class="op">=</span> <span class="va">init</span>, prior <span class="op">=</span> <span class="va">prior</span>, nu <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    model <span class="op">=</span> <span class="st">"t"</span>, tolerance <span class="op">=</span> <span class="fl">1e-2</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span> <span class="co"># the final centers</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              [,1]        [,2]        [,3]        [,4]</span></span>
<span><span class="co">#&gt; [1,] -0.005608544  0.01263007  0.03606995  0.02008999</span></span>
<span><span class="co">#&gt; [2,] -0.036807465 -0.00922546 -0.02606685 -0.03205214</span></span>
<span><span class="co">#&gt; [3,] -0.068637713 -0.06653189 -0.00752340 -0.04191753</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.9785204 0.9459763 0.9561746 0.9857805</span></span>
<span><span class="co">#&gt; [2,] 1.0928959 0.9807877 0.8435277 1.0341407</span></span>
<span><span class="co">#&gt; [3,] 1.1422649 1.0527232 0.9998141 1.0383794</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pi</span><span class="op">)</span> <span class="co"># the final mixing proportion</span></span>
<span><span class="co">#&gt; [1] 0.4999994 0.5000006</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'log Lik.' -442.517 (df=54)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 993.0339</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="co"># the log likelihood by iteration</span></span></code></pre></div>
<p><img src="mixturemodel_files/figure-html/demo-1.png" width="700"></p>
<p>The default method for determining convergence is based on Aitken
acceleration of the log-likelihood. However, it can be set to stop based
on changes in the log-likelihood instead.</p>
</div>
<div class="section level3">
<h3 id="initialization-function">Initialization function<a class="anchor" aria-label="anchor" href="#initialization-function"></a>
</h3>
<p>The packages also provides a helper function
<code><a href="../reference/init_matrixmixture.html">init_matrixmixture()</a></code> to provide the <code>init</code>
object for you. At present, it can either use the <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans()</a></code>
function on the vectorization of the input data to provide starting
centers or select random points. The <code>...</code> arguments are
passed to <code><a href="https://rdrr.io/r/stats/kmeans.html" class="external-link">kmeans()</a></code> (so <code>nstart</code> of other similar
arguments can be set). If a partially formed <code>init</code> object is
sent to the initializer, it will complete it. However, it will not
validate that, for instance, the covariance matrices are valid. Partial
supply of initial centers is also supported - that is, if fewer centers
than groups are provided, the remainder will be chosen by whatever
method selected.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/init_matrixmixture.html">init_matrixmixture</a></span><span class="op">(</span><span class="va">C</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span>, centermethod <span class="op">=</span> <span class="st">'kmeans'</span><span class="op">)</span></span>
<span><span class="co">#&gt; $centers</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             [,1]       [,2]        [,3]         [,4]</span></span>
<span><span class="co">#&gt; [1,]  0.11412574 -0.1191619 -0.04078157  0.127204662</span></span>
<span><span class="co">#&gt; [2,] -0.09798116  0.1763393 -0.02998913  0.001676302</span></span>
<span><span class="co">#&gt; [3,]  0.16767860 -0.1738115 -0.20268828 -0.079679047</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 1.0480976 1.0029779 1.0264273 1.0225414</span></span>
<span><span class="co">#&gt; [2,] 0.9755583 1.0876427 1.0131553 1.2830619</span></span>
<span><span class="co">#&gt; [3,] 0.9418708 0.9333342 0.8656007 0.9025196</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="fu"><a href="../reference/init_matrixmixture.html">init_matrixmixture</a></span><span class="op">(</span><span class="va">C</span>, K <span class="op">=</span> <span class="fl">2</span>, centermethod <span class="op">=</span> <span class="st">'random'</span><span class="op">)</span></span>
<span><span class="co">#&gt; $centers</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;          [,1]      [,2]      [,3]      [,4]</span></span>
<span><span class="co">#&gt; [1,] 1.678144 1.1288934 1.0701532 0.8945011</span></span>
<span><span class="co">#&gt; [2,] 1.452156 1.0876125 0.6176221 1.0579284</span></span>
<span><span class="co">#&gt; [3,] 1.271707 0.8391508 1.0755241 1.3799744</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             [,1]        [,2]       [,3]        [,4]</span></span>
<span><span class="co">#&gt; [1,] -0.13670235 -0.22542286 -0.1013062  0.08921306</span></span>
<span><span class="co">#&gt; [2,]  0.02554019  0.07765350 -0.1971374 -0.09639281</span></span>
<span><span class="co">#&gt; [3,] -0.47626926 -0.03061907  0.1719943 -0.17784713</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt; , , 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; , , 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] MixMatrix_0.2.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] digest_0.6.37       desc_1.4.3          R6_2.5.1           </span></span>
<span><span class="co">#&gt;  [4] fastmap_1.2.0       xfun_0.47           glue_1.7.0         </span></span>
<span><span class="co">#&gt;  [7] cachem_1.1.0        knitr_1.48          htmltools_0.5.8.1  </span></span>
<span><span class="co">#&gt; [10] rmarkdown_2.28      lifecycle_1.0.4     cli_3.6.3          </span></span>
<span><span class="co">#&gt; [13] pkgdown_2.1.1       sass_0.4.9          textshaping_0.4.0  </span></span>
<span><span class="co">#&gt; [16] jquerylib_0.1.4     systemfonts_1.1.0   compiler_4.4.1     </span></span>
<span><span class="co">#&gt; [19] highr_0.11          tools_4.4.1         ragg_1.3.3         </span></span>
<span><span class="co">#&gt; [22] evaluate_1.0.0      bslib_0.8.0         CholWishart_1.1.2.1</span></span>
<span><span class="co">#&gt; [25] Rcpp_1.0.13         yaml_2.3.10         jsonlite_1.8.9     </span></span>
<span><span class="co">#&gt; [28] rlang_1.1.4         fs_1.6.4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="all-the-code-for-easy-copying">All the code for easy copying<a class="anchor" aria-label="anchor" href="#all-the-code-for-easy-copying"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span></span>
<span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gzt/MixMatrix/" class="external-link">MixMatrix</a></span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180221</span><span class="op">)</span></span>
<span> <span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,nrow<span class="op">=</span><span class="fl">3</span>,ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># 3x4 matrices with mean 0</span></span>
<span> <span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="fl">3</span>,ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># 3x4 matrices with mean 2</span></span>
<span> <span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span> <span class="co"># combine into one array</span></span>
<span> <span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span> <span class="co"># equal probability prior</span></span>
<span> <span class="co"># create an intialization object, starts at the true parameters</span></span>
<span> <span class="va">init</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>centers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">12</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              U <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span>
<span> <span class="co"># fit model</span></span>
<span> <span class="va">res</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/matrixmixture.html">matrixmixture</a></span><span class="op">(</span><span class="va">C</span>, init <span class="op">=</span> <span class="va">init</span>, prior <span class="op">=</span> <span class="va">prior</span>, nu <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                    model <span class="op">=</span> <span class="st">"t"</span>, tolerance <span class="op">=</span> <span class="fl">1e-2</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">centers</span><span class="op">)</span> <span class="co"># the final centers</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pi</span><span class="op">)</span> <span class="co"># the final mixing proportion</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="co"># the log likelihood by iteration</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/init_matrixmixture.html">init_matrixmixture</a></span><span class="op">(</span><span class="va">C</span>, prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span>, centermethod <span class="op">=</span> <span class="st">'kmeans'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/init_matrixmixture.html">init_matrixmixture</a></span><span class="op">(</span><span class="va">C</span>, K <span class="op">=</span> <span class="fl">2</span>, centermethod <span class="op">=</span> <span class="st">'random'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-ANDREWS2011520" class="csl-entry">
Andrews, Jeffrey L., Paul D. McNicholas, and Sanjeena Subedi. 2011.
<span>“Model-Based Classification via Mixtures of Multivariate
t-Distributions.”</span> <em>Computational Statistics &amp; Data
Analysis</em> 55 (1): 520–29. <a href="https://doi.org/10.1016/j.csda.2010.05.019" class="external-link">https://doi.org/10.1016/j.csda.2010.05.019</a>.
</div>
<div id="ref-fraley2002model" class="csl-entry">
Fraley, Chris, and Adrian E Raftery. 2002. <span>“Model-Based
Clustering, Discriminant Analysis, and Density Estimation.”</span>
<em>Journal of the American Statistical Association</em> 97 (458):
611–31. <a href="https://doi.org/10.1198/016214502760047131" class="external-link">https://doi.org/10.1198/016214502760047131</a>.
</div>
<div id="ref-mclachlan2019finite" class="csl-entry">
McLachlan, Geoffrey J, Sharon X Lee, and Suren I Rathnayake. 2019.
<span>“Finite Mixture Models.”</span> <em>Annual Review of Statistics
and Its Application</em> 6: 355–78. <a href="https://doi.org/10.1146/annurev-statistics-031017-100325" class="external-link">https://doi.org/10.1146/annurev-statistics-031017-100325</a>.
</div>
<div id="ref-viroliclass2011" class="csl-entry">
Viroli, Cinzia. 2011. <span>“Finite Mixtures of Matrix Normal
Distributions for Classifying Three-Way Data.”</span> <em>Statistics and
Computing</em> 21 (4): 511–22. <a href="https://doi.org/10.1007/s11222-010-9188-x" class="external-link">https://doi.org/10.1007/s11222-010-9188-x</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
