<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matrix Variate Normal Distributions with MixMatrix • MixMatrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Matrix Variate Normal Distributions with MixMatrix">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
    <li>
      <a href="../articles/mixturemodel.html">Matrix Variate Mixture Models with the t distribution</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/MixMatrix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Matrix Variate Normal Distributions with
MixMatrix</h1>
                        <h4 data-toc-skip class="author">Geoffrey
Thompson</h4>
            
            <h4 data-toc-skip class="date">2024-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gzt/MixMatrix/blob/master/vignettes/matrixnormal.Rmd" class="external-link"><code>vignettes/matrixnormal.Rmd</code></a></small>
      <div class="hidden name"><code>matrixnormal.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gzt/MixMatrix/" class="external-link">MixMatrix</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="matrix-variate-distributions">Matrix Variate Distributions<a class="anchor" aria-label="anchor" href="#matrix-variate-distributions"></a>
</h2>
<p>Suppose there is a two-dimensional grid of observations: each
observation is randomly distributed somehow, perhaps each spot on the
grid has its own mean, there’s a covariance relation across the rows
that doesn’t vary across the columns and a covariance relation across
the columns that doesn’t vary across the rows. One case where this might
come up is a multivariate time series: at each point in time we are
dealing with a multivariate observation (perhaps normally distributed or
not) and then there is a covariance structure across time to account
for. We may be interested in drawing from such distributions,
calculating densities, or estimating parameters based on observations.
This package presents some functions for doing so in the case of matrix
variate normal distributions. For more details about matrix variate
distributions in general and matrix variate normal distributions in
particular, see <span class="citation">Gupta and Nagar (<a href="#ref-gupta1999matrix">1999</a>)</span>, whose results I rely on
for much of this presentation.</p>
</div>
<div class="section level2">
<h2 id="matrix-variate-normal-distributions">Matrix Variate Normal Distributions<a class="anchor" aria-label="anchor" href="#matrix-variate-normal-distributions"></a>
</h2>
<p>A random matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(p \times n)</annotation></semantics></math>
with a matrix variate normal distribution is parameterized by a mean
matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐌</mi><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(p \times n)</annotation></semantics></math>
and covariance matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>×</mo><mi>p</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(p \times p)</annotation></semantics></math>
(determining covariance among rows) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐕</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>×</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(n \times n)</annotation></semantics></math>
(determining covariance among columns) and has the following probability
density function (<span class="citation">Wikipedia (<a href="#ref-Matrix_normal_distribution">2018</a>)</span>):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐗</mi><mo>∣</mo><mi>𝐌</mi><mo>,</mo><mi>𝐔</mi><mo>,</mo><mi>𝐕</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mspace width="0.167em"></mspace><mrow><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi></mrow><mrow><mo stretchy="true" form="prefix">[</mo><msup><mi>𝐕</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐗</mi><mo>−</mo><mi>𝐌</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msup><mi>𝐔</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐗</mi><mo>−</mo><mi>𝐌</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>π</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>n</mi><mi>p</mi><mi>/</mi><mn>2</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>𝐕</mi><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mi>n</mi><mi>/</mi><mn>2</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">|</mo><mi>𝐔</mi><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mi>p</mi><mi>/</mi><mn>2</mn></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">p(\mathbf{X}\mid\mathbf{M}, \mathbf{U}, \mathbf{V}) = \frac{\exp\left( -\frac{1}{2} \, \mathrm{tr}\left[ \mathbf{V}^{-1} (\mathbf{X} - \mathbf{M})^{T} \mathbf{U}^{-1} (\mathbf{X} - \mathbf{M}) \right] \right)}{(2\pi)^{np/2} |\mathbf{V}|^{n/2} |\mathbf{U}|^{p/2}} </annotation></semantics></math>
Here is a useful fact for drawing observations from a matrix variate
normal distribution: suppose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐗</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
is distributed as a matrix variate normal distribution with mean matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>𝟎</mn><annotation encoding="application/x-tex">\mathbf{0}</annotation></semantics></math>
and covariance matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐈</mi><mi>𝐧</mi></msub><annotation encoding="application/x-tex">\mathbf{I_n}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐈</mi><mi>𝐩</mi></msub><annotation encoding="application/x-tex">\mathbf{I_p}</annotation></semantics></math>.
Then for a mean matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐌</mi><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math>
and linear transformations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐑</mi><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math>
of appropriate dimensions, if
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>𝐌</mi><mo>+</mo><mi>𝐋</mi><mi>𝐗</mi><mi>𝐑</mi></mrow><annotation encoding="application/x-tex">Y = \mathbf{M} + \mathbf{L}\mathbf{X}\mathbf{R}</annotation></semantics></math>
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐘</mi><annotation encoding="application/x-tex">\mathbf{Y}</annotation></semantics></math>
is matrix variate normally distributed with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>𝐌</mi><mo>,</mo><msup><mrow><mi>𝐋</mi><mi>𝐋</mi></mrow><mi>T</mi></msup><mo>,</mo><msup><mi>𝐑</mi><mi>T</mi></msup><mi>𝐑</mi></mrow><annotation encoding="application/x-tex">\mathbf{M}, \mathbf{LL}^T, \mathbf{R}^T\mathbf{R}</annotation></semantics></math>.</p>
<p>Matrix variate random variables can then be generated by specifying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐌</mi><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐑</mi><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math>
or by specifying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐕</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>.
If the covariance matrices are provided, then Cholesky decomposition is
performed to create the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐑</mi><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math>
matrices. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐑</mi><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math>
matrices are provided, they are used to create
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐕</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>
matrices which are then decomposed. If these are not specified, the
variances are presumed to be identity matrices by default and the means
are presumed to be zero. If
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐋</mi><annotation encoding="application/x-tex">\mathbf{L}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐑</mi><annotation encoding="application/x-tex">\mathbf{R}</annotation></semantics></math>
are not full rank linear transformations, degenerate matrix normal
distributions can be produced.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;             [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.04234611 1.7072872</span></span>
<span><span class="co">#&gt; [2,] -1.05186238 0.2182058</span></span>
<span><span class="co">#&gt; [3,]  0.36199161 0.6759820</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span></span>
<span><span class="co">#&gt;             [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.04234611 1.7072872</span></span>
<span><span class="co">#&gt; [2,] -1.05186238 0.2182058</span></span>
<span><span class="co">#&gt; [3,]  0.36199161 0.6759820</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean<span class="op">=</span><span class="va">mu</span>,U<span class="op">=</span><span class="va">U</span>,V<span class="op">=</span><span class="va">V</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="co">#&gt;           [,1]     [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.146691 5.322459</span></span>
<span><span class="co">#&gt; [2,] -1.568345 5.387067</span></span>
<span><span class="co">#&gt; [3,]  3.734947 6.755212</span></span>
<span><span class="va">mu</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]     [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.146691 5.322459</span></span>
<span><span class="co">#&gt; [2,] -1.568345 5.387067</span></span>
<span><span class="co">#&gt; [3,]  3.734947 6.755212</span></span></code></pre></div>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n=1</annotation></semantics></math>,
by default this returns a matrix. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n&gt;1</annotation></semantics></math>,
by default, it will return a three-dimensional array indexed by the last
coordinate (array convention similar to <code>rWishart</code>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt;             [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.04234611 1.7072872</span></span>
<span><span class="co">#&gt; [2,] -1.05186238 0.2182058</span></span>
<span><span class="co">#&gt; [3,]  0.36199161 0.6759820</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,list <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;             [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.04234611 1.7072872</span></span>
<span><span class="co">#&gt; [2,] -1.05186238 0.2182058</span></span>
<span><span class="co">#&gt; [3,]  0.36199161 0.6759820</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,array <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">z</span><span class="op">[</span> , , <span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt;             [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.04234611 1.7072872</span></span>
<span><span class="co">#&gt; [2,] -1.05186238 0.2182058</span></span>
<span><span class="co">#&gt; [3,]  0.36199161 0.6759820</span></span></code></pre></div>
<p>Densities are computed in much the same way as for other
distributions. The defaults for the mean parameters are 0 and identity
for the variance matrices. The <code>log</code> parameter sets whether
to return the density on the log scale - by default this is
<code>FALSE</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180202</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/rmatrixnorm.html">dmatrixnorm</a></span><span class="op">(</span><span class="va">A</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,log<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="co">#&gt; [1] -4.36614</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="parameter-estimation-for-matrix-variate-normal-distributions">Parameter estimation for matrix variate normal distributions<a class="anchor" aria-label="anchor" href="#parameter-estimation-for-matrix-variate-normal-distributions"></a>
</h2>
<p>Maximum likelihood estimation is possible for the matrix variate
normal distribution (see <span class="citation">Dutilleul (<a href="#ref-dutilleul1999mle">1999</a>)</span> or <span class="citation">Glanz and Carvalho (<a href="#ref-2013arXiv13096609G">2013</a>)</span> for details). The pair
of variance matrices are only identifiable up to a constant, so this
function sets the first element of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>.
There is a closed-form solution for the mean matrix and the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐕</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>
have an iterative solution.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180202</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>   L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,list<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">=</span><span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            [,1]         [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] 99.7692446 -100.2587675   25.0921</span></span>
<span><span class="co">#&gt; [2,] -0.1010964   -0.1537989 -999.9448</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.5011833</span></span>
<span><span class="co">#&gt; [2,] 0.5011833 0.2542832</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt;             [,1]        [,2]         [,3]</span></span>
<span><span class="co">#&gt; [1,] 1.000000000  0.08886027  0.003307182</span></span>
<span><span class="co">#&gt; [2,] 0.088860275  0.99216701 -0.048960852</span></span>
<span><span class="co">#&gt; [3,] 0.003307182 -0.04896085  0.808693731</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] 3.984766</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iter</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tol</span></span>
<span><span class="co">#&gt; [1] 9.830401e-11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logLik</span></span>
<span><span class="co">#&gt; [1] -415.1583 -376.4587 -376.4574 -376.4574 -376.4574</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt; MLmatrixnorm(data = A)</span></span></code></pre></div>
<p>There are two restrictions possible for the mean matrices:
<code>row.mean = TRUE</code> will force a common mean within a row and
<code>col.mean = TRUE</code> will force a common mean within a column.
Setting both will ensure a constant mean for the entire system.
Restrictions on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐔</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐕</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>
are possible with <code>row.variance</code> and
<code>col.variance</code> commands.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results.fixrows</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">A</span>, row.mean <span class="op">=</span> <span class="cn">TRUE</span>, max.iter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in MLmatrixnorm(A, row.mean = TRUE, max.iter = 5): Failed to converge</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results.fixrows</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt; [1,]    8.20086    8.20086    8.20086</span></span>
<span><span class="co">#&gt; [2,] -333.39989 -333.39989 -333.39989</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.4732438</span></span>
<span><span class="co">#&gt; [2,] 0.4732438 0.2752951</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,]  1.000000  1.287832 -2.287827</span></span>
<span><span class="co">#&gt; [2,]  1.287832  1.717146 -3.004973</span></span>
<span><span class="co">#&gt; [3,] -2.287827 -3.004973  5.292803</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] 441310.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iter</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tol</span></span>
<span><span class="co">#&gt; [1] 2.815079e+12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logLik</span></span>
<span><span class="co">#&gt; [1] -3125.019 -3093.986 -3062.230 -3030.199 -2998.804</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt; MLmatrixnorm(data = A, row.mean = TRUE, max.iter = 5)</span></span>
<span><span class="co"># this failure is expected with misspecification! The number of iterations is also </span></span>
<span><span class="co"># fixed to be low so the vignette compiles quickly.</span></span></code></pre></div>
<p>Currently the options for variance restrictions are to impose an
AR(1) structure by providing the <code>AR(1)</code> option, a compound
symmetry structure by providing the <code>CS</code> option, to impose a
correlation matrix structure by specifying <code>correlation</code> or
<code>corr</code>, or to impose an identical and independent structure
by specifying <code>Independent</code> or <code>I</code>. This works by
using <code>uniroot</code> to find the appropriate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
which sets the derivative of the log-likelihood to zero for the
<code>AR</code> and <code>CS</code> options - it is not fast but if this
is the true structure it will be better in some sense than an
unstructured variance matrix. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
parameter should be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">&gt;0</annotation></semantics></math>
and is forced to be non-negative. If the data behaves incompatibly with
those restrictions, the function will provide a warning and exit with
the current model fit.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># tolerance and maximum iterations are limited here to make the vignette compile faster</span></span>
<span></span>
<span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>                U <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/toeplitz.html" class="external-link">toeplitz</a></span><span class="op">(</span><span class="fl">.6</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">B</span>, row.variance <span class="op">=</span> <span class="st">"AR(1)"</span>, tol <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;           [,1]     [,2]     [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.9879945 5.976905 10.88718</span></span>
<span><span class="co">#&gt; [2,] 1.8732469 6.852212 12.18793</span></span>
<span><span class="co">#&gt; [3,] 2.9224880 7.939933 13.30729</span></span>
<span><span class="co">#&gt; [4,] 4.2194033 9.036333 14.06759</span></span>
<span><span class="co">#&gt; [5,] 5.2340302 9.857787 14.63149</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.5839991 0.3410550 0.1991758 0.1163185</span></span>
<span><span class="co">#&gt; [2,] 0.5839991 1.0000000 0.5839991 0.3410550 0.1991758</span></span>
<span><span class="co">#&gt; [3,] 0.3410550 0.5839991 1.0000000 0.5839991 0.3410550</span></span>
<span><span class="co">#&gt; [4,] 0.1991758 0.3410550 0.5839991 1.0000000 0.5839991</span></span>
<span><span class="co">#&gt; [5,] 0.1163185 0.1991758 0.3410550 0.5839991 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt;              [,1]         [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000000 0.0001430499 0.005716386</span></span>
<span><span class="co">#&gt; [2,] 0.0001430499 0.8494982020 0.035590626</span></span>
<span><span class="co">#&gt; [3,] 0.0057163858 0.0355906255 0.979331742</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] 1.853556</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iter</span></span>
<span><span class="co">#&gt; [1] 12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tol</span></span>
<span><span class="co">#&gt; [1] 8.864026e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logLik</span></span>
<span><span class="co">#&gt;  [1] -1156.249 -1149.718 -1148.332 -1147.872 -1147.712 -1147.651 -1147.627</span></span>
<span><span class="co">#&gt;  [8] -1147.617 -1147.614 -1147.612 -1147.611 -1147.611</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt; MLmatrixnorm(data = B, row.variance = "AR(1)", tol = 1e-05)</span></span>
<span><span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">B</span>, tol <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;           [,1]     [,2]     [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.9879945 5.976905 10.88718</span></span>
<span><span class="co">#&gt; [2,] 1.8732469 6.852212 12.18793</span></span>
<span><span class="co">#&gt; [3,] 2.9224880 7.939933 13.30729</span></span>
<span><span class="co">#&gt; [4,] 4.2194033 9.036333 14.06759</span></span>
<span><span class="co">#&gt; [5,] 5.2340302 9.857787 14.63149</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.5088212 0.3116836 0.2418073 0.1278731</span></span>
<span><span class="co">#&gt; [2,] 0.5088212 0.9878158 0.6383707 0.3910373 0.3114872</span></span>
<span><span class="co">#&gt; [3,] 0.3116836 0.6383707 1.1270834 0.6297656 0.4495454</span></span>
<span><span class="co">#&gt; [4,] 0.2418073 0.3910373 0.6297656 1.0046405 0.6505338</span></span>
<span><span class="co">#&gt; [5,] 0.1278731 0.3114872 0.4495454 0.6505338 1.0516576</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt;             [,1]        [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,] 1.000000000 0.005092835 0.009893861</span></span>
<span><span class="co">#&gt; [2,] 0.005092835 0.836800036 0.034013446</span></span>
<span><span class="co">#&gt; [3,] 0.009893861 0.034013446 0.972453799</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] 1.8111</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iter</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tol</span></span>
<span><span class="co">#&gt; [1] 2.457002e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logLik</span></span>
<span><span class="co">#&gt; [1] -1145.534 -1143.775 -1143.767 -1143.766</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt; MLmatrixnorm(data = B, tol = 1e-05)</span></span></code></pre></div>
<p>In order to fit parameters for an
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \times p</annotation></semantics></math>
matrix variate normal distribution, at least
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mi>/</mi><mi>p</mi><mo>,</mo><mi>p</mi><mi>/</mi><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\max (n/p,p/n) + 1</annotation></semantics></math>
observations are needed. Maximum likelihood estimates are unique if
there are more than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\max(p,n)</annotation></semantics></math>
observations.</p>
<p>The function expects data in a format produced by the
<code>rmatrixnorm</code> function. The results are only the parameter
estimates and do not include measures of uncertainty.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<p>This vignette was compiled with <code>rmarkdown</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] MixMatrix_0.2.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] digest_0.6.37     desc_1.4.3        R6_2.5.1          fastmap_1.2.0    </span></span>
<span><span class="co">#&gt;  [5] xfun_0.47         glue_1.7.0        cachem_1.1.0      knitr_1.48       </span></span>
<span><span class="co">#&gt;  [9] htmltools_0.5.8.1 rmarkdown_2.28    lifecycle_1.0.4   cli_3.6.3        </span></span>
<span><span class="co">#&gt; [13] pkgdown_2.1.1     sass_0.4.9        textshaping_0.4.0 jquerylib_0.1.4  </span></span>
<span><span class="co">#&gt; [17] systemfonts_1.1.0 compiler_4.4.1    tools_4.4.1       ragg_1.3.3       </span></span>
<span><span class="co">#&gt; [21] evaluate_1.0.0    bslib_0.8.0       Rcpp_1.0.13       yaml_2.3.10      </span></span>
<span><span class="co">#&gt; [25] jsonlite_1.8.9    rlang_1.1.4       fs_1.6.4</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="all-the-code-for-easy-copying">All the code for easy copying<a class="anchor" aria-label="anchor" href="#all-the-code-for-easy-copying"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">y</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="va">V</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean<span class="op">=</span><span class="va">mu</span>,U<span class="op">=</span><span class="va">U</span>,V<span class="op">=</span><span class="va">V</span><span class="op">)</span></span>
<span><span class="va">z</span></span>
<span><span class="va">mu</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">U</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">y</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/chol.html" class="external-link">chol</a></span><span class="op">(</span><span class="va">V</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,list <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180203</span><span class="op">)</span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">6</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,array <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">z</span><span class="op">[</span> , , <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180202</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/rmatrixnorm.html">dmatrixnorm</a></span><span class="op">(</span><span class="va">A</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,log<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20180202</span><span class="op">)</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>   L<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">.1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,list<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">=</span><span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="va">results.fixrows</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">A</span>, row.mean <span class="op">=</span> <span class="cn">TRUE</span>, max.iter <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results.fixrows</span><span class="op">)</span></span>
<span><span class="co"># this failure is expected with misspecification! The number of iterations is also </span></span>
<span><span class="co"># fixed to be low so the vignette compiles quickly.</span></span>
<span><span class="co"># tolerance and maximum iterations are limited here to make the vignette compile faster</span></span>
<span></span>
<span><span class="va">B</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixnorm.html">rmatrixnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>, </span>
<span>                U <span class="op">=</span> <span class="fl">3</span><span class="op">*</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/toeplitz.html" class="external-link">toeplitz</a></span><span class="op">(</span><span class="fl">.6</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">B</span>, row.variance <span class="op">=</span> <span class="st">"AR(1)"</span>, tol <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/MLmatrixnorm.html">MLmatrixnorm</a></span><span class="op">(</span><span class="va">B</span>, tol <span class="op">=</span> <span class="fl">1e-5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dutilleul1999mle" class="csl-entry">
Dutilleul, Pierre. 1999. <span>“The MLE Algorithm for the Matrix Normal
Distribution.”</span> <em>Journal of Statistical Computation and
Simulation</em> 64 (2): 105–23.
</div>
<div id="ref-2013arXiv13096609G" class="csl-entry">
Glanz, H., and L. Carvalho. 2013. <span>“<span class="nocase">An
Expectation-Maximization Algorithm for the Matrix Normal
Distribution</span>.”</span> <em>ArXiv e-Prints</em>, September. <a href="https://arxiv.org/abs/1309.6609" class="external-link">https://arxiv.org/abs/1309.6609</a>.
</div>
<div id="ref-gupta1999matrix" class="csl-entry">
Gupta, Arjun K, and Daya K Nagar. 1999. <em>Matrix Variate
Distributions</em>. Vol. 104. CRC Press.
</div>
<div id="ref-Matrix_normal_distribution" class="csl-entry">
Wikipedia. 2018. <span>“<span class="nocase">Matrix normal
distribution</span> — <span>W</span>ikipedia<span>,</span> the Free
Encyclopedia.”</span> <a href="https://en.wikipedia.org/w/index.php?title=Matrix%20normal%20distribution&amp;oldid=757552257" class="external-link uri">https://en.wikipedia.org/w/index.php?title=Matrix%20normal%20distribution&amp;oldid=757552257</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
