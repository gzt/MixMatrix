<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ML estimation of the Matrix Variate t Distribution ‚Ä¢ MixMatrix</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ML estimation of the Matrix Variate t Distribution">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MixMatrix</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/discriminant-analysis.html">Discriminant Analysis for Matrix Variate Distributions</a>
    </li>
    <li>
      <a href="../articles/matrix-t-estimation.html">ML estimation of the Matrix Variate t Distribution</a>
    </li>
    <li>
      <a href="../articles/matrixnormal.html">Matrix Variate Normal Distributions with MixMatrix</a>
    </li>
    <li>
      <a href="../articles/mixturemodel.html">Matrix Variate Mixture Models with the t distribution</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/MixMatrix/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ML estimation of the Matrix Variate t
Distribution</h1>
                        <h4 data-toc-skip class="author">Geoffrey
Thompson</h4>
            
            <h4 data-toc-skip class="date">2024-09-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/gzt/MixMatrix/blob/master/vignettes/matrix-t-estimation.Rmd" class="external-link"><code>vignettes/matrix-t-estimation.Rmd</code></a></small>
      <div class="hidden name"><code>matrix-t-estimation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gzt/MixMatrix/" class="external-link">MixMatrix</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="estimation-of-the-matrix-variate-t-distribution">Estimation of the Matrix Variate <em>t</em> Distribution<a class="anchor" aria-label="anchor" href="#estimation-of-the-matrix-variate-t-distribution"></a>
</h2>
<p>The parameters of the multivariate <em>t</em> distribution can be
estimated using the EM algorithm. An EM algorithm for the multivariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>-distribution
with no missing data was provided by <span class="citation">Rubin (<a href="#ref-rubin1983">1983</a>)</span>. This was variously extended and
refined, as the EM algorithm can be quite slow to converge. One set of
refinements split the M-step into a series of conditional maximization
(CM) steps <span class="citation">(<a href="#ref-meng1993">Meng and
Rubin 1993</a>)</span>, and then a later refinement (called ECME -
Expectation/Conditional Maximization Either) allowed for <em>either</em>
conditional maximization steps or maximizing the constrained actual
likelihood <span class="citation">(<a href="#ref-liurubin1994">Liu and
Rubin 1994</a>)</span>, which leads to dramatically faster convergence.
The matrix variate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
is an extension of the multivariate version <span class="citation">(<a href="#ref-dickey1967">Dickey 1967</a>)</span>; however, unlike the
normal distribution, it cannot be treated as a rearrangement of the
multivariate case, so the addition of the extra dimension poses a
non-trivial problem for extending the results.</p>
<p>An
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>√ó</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \times p</annotation></semantics></math>
random matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêó</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
is distributed as a matrix variate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
random variable if it has probability density function as follows: <span class="math display">$$f({\mathbf  {X}};\nu,{\mathbf  {M}},
{\boldsymbol  \Omega }, {\boldsymbol  \Sigma }) =  {\frac  {\Gamma
_{p}\left({\frac  {\nu +n+p-1}{2}}\right)}{(\pi
)^{{\frac  {np}{2}}}\Gamma _{p}\left({\frac  {\nu
+p-1}{2}}\right)}}|{\boldsymbol  \Omega
}|^{{-{\frac  {n}{2}}}}|{\boldsymbol  \Sigma
}|^{{-{\frac  {p}{2}}}}\times
\left|{\mathbf  {I}}_{n}+{\boldsymbol  \Sigma
}^{{-1}}({\mathbf  {X}}-{\mathbf  {M}}){\boldsymbol  \Omega
}^{{-1}}({\mathbf  {X}}-{\mathbf  {M}})^{{{\rm
{T}}}}\right|^{{-{\frac  {\nu +n+p-1}{2}}}}$$</span></p>
<p>With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ©</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
covariance matrices of appropriate dimension,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêå</mi><annotation encoding="application/x-tex">\mathbf{M}</annotation></semantics></math>
a mean matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
the degrees of freedom parameter, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œì</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma_p()</annotation></semantics></math>
the multivariate gamma function, which is implemented in the <a href="https://gzt.github.io/CholWishart/" class="external-link"><code>CholWishart</code></a>
package available on CRAN.</p>
<p>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ£</mi><mo>=</mo><mi>ŒΩ</mi></mrow><annotation encoding="application/x-tex">\Sigma = \nu</annotation></semantics></math>
(or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">q = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ©</mi><mo>=</mo><mi>ŒΩ</mi></mrow><annotation encoding="application/x-tex">\Omega = \nu</annotation></semantics></math>),
this reduces to the familiar multivariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distribution. If the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>√ó</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p \times q</annotation></semantics></math>
dimensional random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
follows the matrix variate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>,</mo><mi>M</mi><mo>,</mo><mi>Œ£</mi><mo>,</mo><mi>Œ©</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">t(\nu, M, \Sigma, \Omega)</annotation></semantics></math>
with center
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math>,
positive definite spread matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>√ó</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">p \times p</annotation></semantics></math>)
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ©</mi><annotation encoding="application/x-tex">\Omega</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>√ó</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">q \times q</annotation></semantics></math>),
and degrees of freedom
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>,
it can be shown that, given a certain weight matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math>
has a matrix variate normal distribution and that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>
is Wishart-distributed. Specifically,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>X</mi><mo stretchy="false" form="prefix">|</mo><mi>M</mi><mo>,</mo><mi>Œ£</mi><mo>,</mo><mi>Œ©</mi><mo>,</mo><mi>ŒΩ</mi><mo>,</mo><mi>S</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>‚àº</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>,</mo><msup><mi>S</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚äó</mo><mi>Œ©</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mi>S</mi><mo stretchy="false" form="prefix">|</mo><mi>M</mi><mo>,</mo><mi>Œ©</mi><mo>,</mo><mi>Œ£</mi><mo>,</mo><mi>ŒΩ</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>‚àº</mo><msub><mi>W</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><msup><mi>Œ£</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
X | M, \Sigma, \Omega, \nu, S &amp; \sim  N(M, S^{-1} \otimes \Omega) \\
S|M, \Omega, \Sigma, \nu &amp; \sim  W_p(\nu + p  -1, \Sigma^{-1})
\end{align*}</annotation></semantics></math> Additionally, it can be
shown the Wishart is the conjugate prior distribution for the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>,
and thus the conditional posterior distribution of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>,
i.e., its distribution given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>,</mo><mi>Œ©</mi><mo>,</mo><mi>Œ£</mi><mo>,</mo><mi>ŒΩ</mi><mo>,</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(M, \Omega, \Sigma, \nu, X)</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo stretchy="false" form="prefix">|</mo><mi>X</mi><mo>,</mo><mi>M</mi><mo>,</mo><mi>Œ©</mi><mo>,</mo><mi>Œ£</mi><mo>,</mo><mi>ŒΩ</mi><mo>‚àº</mo><msub><mi mathvariant="normal">W</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>‚àí</mo><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>Œ©</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>‚àí</mo><mi>M</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo>+</mo><mi>Œ£</mi><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S | X, M, \Omega, \Sigma, \nu \sim \mathrm{W}_p(\nu+p+q-1, [(X-M)\Omega^{-1}(X-M)^T + \Sigma]^{-1})   </annotation></semantics></math></p>
<p>For an observed set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>‚Ä¶</mi><mo>,</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">i = 1, 2, \ldots, N</annotation></semantics></math>,
then, we can construct an ECM-style algorithm by augmenting our data
with a set of weights,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>i</mi></msub><annotation encoding="application/x-tex">S_i</annotation></semantics></math>,
and use this to estimate the parameters of the matrix variate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distribution. Briefly, we define a set of complete data sufficient
statistics based on the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>i</mi></msub><annotation encoding="application/x-tex">S_i</annotation></semantics></math>
and update them with their expectations in the E-step. Then, the other
parameters are maximized in the CM steps.</p>
<p>The complete data sufficient statistics for the quantities to be
estimated are:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>S</mi><mi>X</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>S</mi><mi>i</mi></msub><msub><mi>X</mi><mi>i</mi></msub><mo>;</mo><mspace width="1.0em"></mspace><msub><mi>S</mi><mi>S</mi></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>S</mi><mi>i</mi></msub><mo>;</mo><mspace width="1.0em"></mspace><msub><mi>S</mi><mrow><mi>X</mi><mi>S</mi><mi>X</mi></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>S</mi><mi>i</mi></msub><msub><mi>X</mi><mi>i</mi></msub><mspace width="1.0em"></mspace><msub><mi>S</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>S</mi><mo stretchy="true" form="postfix">|</mo></mrow></msub><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mi>S</mi><mi>i</mi><mo stretchy="true" form="postfix">|</mo></mrow></mrow><annotation encoding="application/x-tex">S_{SX} =\sum_{i = 1}^N S_i X_i; \quad S_S =  \sum_{i = 1}^N S_i; \quad S_{XSX} =  \sum_{i = 1}^N  X_i^T S_i X_i \quad S_{|S|} = \sum_{i = 1}^N \log |Si|</annotation></semantics></math></p>
<div class="section level3">
<h3 id="e-step">E-step<a class="anchor" aria-label="anchor" href="#e-step"></a>
</h3>
<p>Define at step
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
the set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><mo>,</mo><msup><mi>ŒΩ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>Œ£</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>,</mo><msup><mi>Œ©</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Theta^{(t)} = (X_{obs},\nu^{(t)}, M^{(t)}, \Sigma^{(t)}, \Omega^{(t)})</annotation></semantics></math>.
Then, given these values, we have, based on the properties of the
Wishart distribution,
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ŒΩ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><msup><mrow><mo stretchy="true" form="prefix">[</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>‚àí</mo><msup><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>Œ©</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>‚àí</mo><msup><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><mo>+</mo><msup><mi>Œ£</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">S_{i}^{(t+1)} = E(S_i | \Theta^{(t)}) = (\nu^{(t)}+p+q-1)[(X_i-M^{(t)})\Omega^{(t)^{-1 }}(X_i-M^{(t)})^T + \Sigma^{(t)}]^{-1} </annotation></semantics></math>
From this we can derive the other expected values:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>S</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mi>S</mi></msub><mo stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>S</mi><mrow><mi>S</mi><mi>X</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>S</mi><mi>X</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mi>i</mi></msub><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msub><mi>X</mi><mi>i</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>S</mi><mrow><mi>X</mi><mi>S</mi><mi>X</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>X</mi><mi>S</mi><mi>X</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>S</mi><mi>i</mi></msub><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mi>X</mi><mi>i</mi><mi>T</mi></msubsup><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msub><mi>X</mi><mi>i</mi></msub></mtd></mtr></mtable><annotation encoding="application/x-tex">
 \begin{align*}
S_{S}^{(t+1)} &amp;= E(S_S | \Theta^{(t)}) = \sum_{i=1}^N S_{i}^{(t+1)} \\
S_{SX}^{(t+1)} &amp;= E(S_{SX} | \Theta^{(t)}) =  \sum_{i=1}^NE(S_iX_i|\Theta^{(t)}) = \sum_{i=1}^N S_{i}^{(t+1)}X_i \\
S_{XSX}^{(t+1)} &amp;= E(S_{XSX} | \Theta^{(t)}) =  \sum_{i=1}^NE(X_i^TS_iX_i|\Theta^{(t)}) = \sum_{i=1}^N X_i^TS_{i}^{(t+1)}X_i
\end{align*}
</annotation></semantics></math> This last value only needs to be
computed if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
is unknown:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msubsup><mi>S</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>S</mi><mo stretchy="true" form="postfix">|</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>S</mi><mo stretchy="true" form="postfix">|</mo></mrow></msub><mo stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>S</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">|</mo><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">]</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>N</mi><msub><mi>œà</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>ŒΩ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>N</mi><mi>p</mi><mo>log</mo><mn>2</mn><mo>+</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msubsup><mi>S</mi><mrow><mi>i</mi><mo>,</mo><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><msup><mi>ŒΩ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
S_{|S|}^{(t+1)} &amp;= E(S_{|S|} | \Theta^{(t)}) = E \left[\sum_{i = 1}^N \log| S_i|  \big| \Theta^{(t)} \right]\\
&amp;=N\psi_{p}\left({\frac {\nu^{(t)} + p + q -1}{2}}\right) + Np \log 2 +\sum_{i=1}^N \log \left|\frac{S_{i,obs}^{(t+1)}}{\nu^{(t)} + p + q -1}\right|
\end{align*}
</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="cm-steps">CM Steps<a class="anchor" aria-label="anchor" href="#cm-steps"></a>
</h3>
<p>Similarly to the case of the multivariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>,
it is more efficient to partition the maximization step into multiple
steps. This is an ECME algorithm that first maximizes the expected
log-likelihood for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>,</mo><mi>Œ£</mi><mo>,</mo><mi>Œ©</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(M, \Sigma, \Omega)</annotation></semantics></math>
and then maximizes the actual log-likelihood over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>M</mi><mo>,</mo><mi>Œ£</mi><mo>,</mo><mi>Œ©</mi><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(M, \Sigma, \Omega)</annotation></semantics></math>,
similar to .</p>
<p>Based on the updated weight matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><annotation encoding="application/x-tex">S_i^{(t+1)}</annotation></semantics></math>
and statistics based on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Œò</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><annotation encoding="application/x-tex">\Theta^{(t)}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">X_{obs}</annotation></semantics></math>,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>M</mi><mo accent="true">ÃÇ</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>S</mi><mi>i</mi></msub><msub><mi>X</mi><mi>i</mi></msub><mo>=</mo><msup><msubsup><mi>S</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><msubsup><mi>S</mi><mrow><mi>S</mi><mi>X</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mover><mi>Œ©</mi><mo accent="true">ÃÇ</mo></mover></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mi>p</mi></mrow></mfrac><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>‚àí</mo><msup><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>T</mi></msup><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo>‚àí</mo><msup><mi>M</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mi>p</mi></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>S</mi><mrow><mi>X</mi><mi>S</mi><mi>X</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>‚àí</mo><msup><msubsup><mi>S</mi><mrow><mi>S</mi><mi>X</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mi>T</mi></msup><msup><msubsup><mi>S</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><msubsup><mi>S</mi><mrow><mi>S</mi><mi>X</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><msup><mover><mi>Œ£</mi><mo accent="true">ÃÇ</mo></mover><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mfrac><mn>1</mn><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ŒΩ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msubsup><mi>S</mi><mi>i</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>=</mo><mfrac><msubsup><mi>S</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ŒΩ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
\widehat{M} &amp;= \left(\sum_{i = 1}^NS_i^{(t+1)}\right)^{-1}\sum_{i=1}^NS_iX_i  = {S_{S}^{(t+1)}}^{-1} S_{SX}^{(t+1)} \\
\widehat{\Omega} &amp;= \frac{1}{Np} \sum_{i = 1}^N (X_i - {M}^{(t)})^T S_i^{(t+1)} (X_i - {M}^{(t)}) =\frac{1}{Np} \left(S_{XSX}^{(t+1)} - {S_{SX}^{(t+1)}}^T {S_{S}^{(t+1)}}^{-1}{S_{SX}^{(t+1)}}  \right) \\
 \widehat{\Sigma}^{-1} &amp;= \frac{1}{N(\nu^{(t)}+p-1)}\sum_{i = 1}^N S_i^{(t+1)} = \frac{S_S^{(t+1)}}{N(\nu^{(t)}+p-1)}
\end{align*}
</annotation></semantics></math> And, again, with the set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mi>i</mi></msub><annotation encoding="application/x-tex">S_i</annotation></semantics></math>
observed, the MLE of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
can be obtained:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mfrac><mi>d</mi><mrow><mi>d</mi><mi>ŒΩ</mi></mrow></mfrac><mo>log</mo><msub><mi>Œì</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mo stretchy="true" form="prefix">|</mo><mi>S</mi><mo stretchy="true" form="postfix">|</mo></mrow></msub><mo>‚àí</mo><mi>N</mi><mi>p</mi><mo>log</mo><mn>2</mn><mo>+</mo><mi>N</mi><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mover><mi>Œ£</mi><mo accent="true">ÃÇ</mo></mover><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex"> N \frac{d}{d\nu}\log \Gamma_p ((\nu+p-1)/2) - \frac{1}{2} (S_{|S|} - Np\log2 + N \log |\widehat{\Sigma}|) = 0</annotation></semantics></math>
Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ŒΩ</mi><mo>&gt;</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\nu &gt; p -1</annotation></semantics></math>.
Specifically, we have:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>N</mi><msub><mi>œà</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>N</mi><msub><mi>œà</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msubsup><mi>S</mi><mrow><mi>i</mi><mo>,</mo><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo>‚àí</mo><mi>N</mi><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><mfrac><msubsup><mi>S</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mo>*</mo></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>œà</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚àí</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>œà</mi><mi>p</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>‚àë</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><msubsup><mi>Z</mi><mrow><mi>i</mi><mo>,</mo><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">|</mo></mrow><mo>+</mo><mi>p</mi><mo>log</mo><mfrac><mrow><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn></mrow></mfrac><mo>‚àí</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">|</mo><msubsup><mi>Z</mi><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo stretchy="true" form="postfix">|</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
 0 &amp;= N \psi_p((\nu+p-1)/2) -  \left(N\psi_{p}\left({\frac {\nu + p + q -1}{2}}\right)  +\sum_{i=1}^N \log \left|\frac{S_{i,obs}^{(t+1)}}{\nu + p + q -1}\right| - N \log \left|\frac{S_S^{(t+1)}}{N(\nu+p-1)}\right|\right) \\*
 &amp;=  \psi_p((\nu+p-1)/2) - \left(\psi_{p}\left({\frac {\nu + p + q -1}{2}}\right)  +\frac{1}{N}\sum_{i=1}^N \log \left|Z_{i,obs}^{(t+1)}\right| + p \log \frac{N(\nu + p -1)}{\nu + p +q -1} - \log \left|Z_S^{(t+1)}\right|\right)
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mo>*</mo></msub><annotation encoding="application/x-tex">Z_{*}</annotation></semantics></math>
is the appropriate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mo>*</mo></msub><annotation encoding="application/x-tex">S_{*}</annotation></semantics></math>
statistic with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mi>ŒΩ</mi><mo>+</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\nu + p + q -1)</annotation></semantics></math>
factored out and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mi>p</mi></msub><annotation encoding="application/x-tex">\psi_p</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-dimensional
digamma function. This can be solved for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
using a 1-dimensional search.</p>
</div>
</div>
<div class="section level2">
<h2 id="applications-and-results">Applications and results<a class="anchor" aria-label="anchor" href="#applications-and-results"></a>
</h2>
<div class="section level3">
<h3 id="with-nu-known">With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
known<a class="anchor" aria-label="anchor" href="#with-nu-known"></a>
</h3>
<p>If the degrees of freedom parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
known, the estimation is fairly straightforward. The procedure is
similar to the multivariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
or the matrix variate normal. In this case, the interface is just like
the interface for the <code><a href="../reference/MLmatrixnorm.html">MLmatrixnorm()</a></code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20190622</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">7</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/rWishart.html" class="external-link">rWishart</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>   V <span class="op">=</span> <span class="va">sigma</span>, df <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">=</span><span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="va">A</span>, df <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;            [,1]          [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,] 99.8291911 -1.000708e+02    25.01042</span></span>
<span><span class="co">#&gt; [2,] -0.0425028 -8.261356e-03 -1000.02357</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $U</span></span>
<span><span class="co">#&gt;             [,1]        [,2]</span></span>
<span><span class="co">#&gt; [1,]  1.00000000 -0.08039981</span></span>
<span><span class="co">#&gt; [2,] -0.08039981  0.97069319</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $V</span></span>
<span><span class="co">#&gt;           [,1]       [,2]       [,3]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.21375613 0.11094767</span></span>
<span><span class="co">#&gt; [2,] 0.2137561 0.14872070 0.04098332</span></span>
<span><span class="co">#&gt; [3,] 0.1109477 0.04098332 0.12860660</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $var</span></span>
<span><span class="co">#&gt; [1] 5.148569</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $nu</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $iter</span></span>
<span><span class="co">#&gt; [1] 44</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tol</span></span>
<span><span class="co">#&gt; [1] 1.155394e-08</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $logLik</span></span>
<span><span class="co">#&gt; [1] -386.7623</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $convergence</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $call</span></span>
<span><span class="co">#&gt; MLmatrixt(data = A, df = 7)</span></span></code></pre></div>
<p>There are two restrictions possible for the mean matrices:
<code>row.mean = TRUE</code> will force a common mean within a row and
<code>col.mean = TRUE</code> will force a common mean within a column.
Setting both will ensure a constant mean for the entire system.
Restrictions on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêî</mi><annotation encoding="application/x-tex">\mathbf{U}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêï</mi><annotation encoding="application/x-tex">\mathbf{V}</annotation></semantics></math>,
the row-wise variance and column-wise variance, are possible with
<code>row.variance</code> and <code>col.variance</code> commands.</p>
<p>The options for variance restrictions are the same as for the
<code><a href="../reference/MLmatrixnorm.html">MLmatrixnorm()</a></code> function. Currently the options for variance
restrictions are to impose an AR(1) structure by providing the
<code>AR(1)</code> option, a compound symmetry structure by providing
the <code>CS</code> option, to impose a correlation matrix structure by
specifying <code>correlation</code> or <code>corr</code>, or to impose
an identical and independent structure by specifying
<code>Independent</code> or <code>I</code>. This works by using
<code>uniroot</code> to find the appropriate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
which sets the derivative of the log-likelihood to zero for the
<code>AR</code> and <code>CS</code> options - it is not fast but if this
is the true structure it will be better in some sense than an
unstructured variance matrix. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
parameter should be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">&gt;0</annotation></semantics></math>
and is forced to be non-negative. If the data behaves incompatibly with
those restrictions, the function will provide a warning and exit with
the current model fit.</p>
</div>
<div class="section level3">
<h3 id="with-nu-unknown">With
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
unknown<a class="anchor" aria-label="anchor" href="#with-nu-unknown"></a>
</h3>
<p>Estimation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ŒΩ</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>,
the degrees of freedom parameter, is slow and the principal mathematical
difficulty of the matrix-variate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distribution. It is performed using ECME. Generally, a fair amount more
data are needed in order to have good convergence properties for the
estimator, but they have not been derived analytically. Here you can see
the recovery of the parameter for a few sample sizes. Because of the
relative slowness of running a longer simulation, this only includes one
set of examples. I give code for a longer and larger simulation than
what is plotted if you‚Äôre really interested below. What is plotted below
is only the <code>df = 10</code> example with 75 trials and a maximum
number of iterations <code>max.iter =  20</code>. The full simulation
may take several minutes.</p>
<p><img src="matrix-t-estimation_files/figure-html/dftenexample-1.png" width="700"></p>
<table class="table">
<thead><tr class="header">
<th align="left">samplesize</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">median</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">25</td>
<td align="right">7.059192</td>
<td align="right">15.76929</td>
<td align="right">10.316514</td>
<td align="right">10.512701</td>
<td align="right">2.0603677</td>
</tr>
<tr class="even">
<td align="left">50</td>
<td align="right">7.220806</td>
<td align="right">14.47148</td>
<td align="right">10.424858</td>
<td align="right">10.415426</td>
<td align="right">1.6347640</td>
</tr>
<tr class="odd">
<td align="left">100</td>
<td align="right">8.281614</td>
<td align="right">11.85454</td>
<td align="right">9.826301</td>
<td align="right">9.859941</td>
<td align="right">0.8019631</td>
</tr>
</tbody>
</table>
<p>As expected, increased sample size leads to better results in
recovering the parameter. The results for smaller sample sizes would be
more divergent if left to run until convergence.</p>
</div>
</div>
<div class="section level2">
<h2 id="use-for-classification">Use for classification<a class="anchor" aria-label="anchor" href="#use-for-classification"></a>
</h2>
<p>Using the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
distribution works in both <code><a href="../reference/matrixlda.html">matrixlda()</a></code> and
<code><a href="../reference/matrixqda.html">matrixqda()</a></code> as expected by specifying
<code>method = "t"</code> and providing either a single parameter (for
<code>lda</code> or <code>qda</code>) for the degrees of freedom or a
vector as long as the number of classes (for <code>qda</code>).
Additional parameters for fitting can be passed through the
<code>...</code> to <code><a href="../reference/MLmatrixt.html">MLmatrixt()</a></code> just as for the normal
case, including estimating the degrees of freedom parameter. The
<code>qda</code> will only estimate <code>nu</code> with it varying
between groups, it will not estimate a common <code>nu</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ABC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span>,<span class="va">C</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"C"</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">30</span><span class="op">)</span><span class="op">/</span><span class="fl">90</span></span>
<span><span class="va">matlda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrixlda.html">matrixlda</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ABC</span>,grouping <span class="op">=</span> <span class="va">groups</span>, prior <span class="op">=</span> <span class="va">prior</span>,</span>
<span>                    method <span class="op">=</span> <span class="st">'t'</span>, nu <span class="op">=</span> <span class="fl">10</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">matlda</span>, newdata <span class="op">=</span> <span class="va">ABC</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">31</span>,<span class="fl">61</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $class</span></span>
<span><span class="co">#&gt; [1] A B C</span></span>
<span><span class="co">#&gt; Levels: A B C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $posterior</span></span>
<span><span class="co">#&gt;              [,1]         [,2]         [,3]</span></span>
<span><span class="co">#&gt; [1,] 9.997064e-01 2.849389e-04 8.693417e-06</span></span>
<span><span class="co">#&gt; [2,] 4.174839e-05 9.999508e-01 7.439619e-06</span></span>
<span><span class="co">#&gt; [3,] 8.908508e-06 4.857627e-06 9.999862e-01</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<p>This vignette was built using <code>rmarkdown</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.4.1 (2024-06-14)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.5 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] magrittr_2.0.3  dplyr_1.1.4     ggplot2_3.5.1   MixMatrix_0.2.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gtable_0.3.5        jsonlite_1.8.9      highr_0.11         </span></span>
<span><span class="co">#&gt;  [4] compiler_4.4.1      tidyselect_1.2.1    Rcpp_1.0.13        </span></span>
<span><span class="co">#&gt;  [7] jquerylib_0.1.4     systemfonts_1.1.0   scales_1.3.0       </span></span>
<span><span class="co">#&gt; [10] textshaping_0.4.0   yaml_2.3.10         fastmap_1.2.0      </span></span>
<span><span class="co">#&gt; [13] R6_2.5.1            labeling_0.4.3      generics_0.1.3     </span></span>
<span><span class="co">#&gt; [16] knitr_1.48          tibble_3.2.1        desc_1.4.3         </span></span>
<span><span class="co">#&gt; [19] munsell_0.5.1       bslib_0.8.0         pillar_1.9.0       </span></span>
<span><span class="co">#&gt; [22] rlang_1.1.4         utf8_1.2.4          cachem_1.1.0       </span></span>
<span><span class="co">#&gt; [25] xfun_0.47           fs_1.6.4            sass_0.4.9         </span></span>
<span><span class="co">#&gt; [28] cli_3.6.3           withr_3.0.1         pkgdown_2.1.1      </span></span>
<span><span class="co">#&gt; [31] digest_0.6.37       grid_4.4.1          CholWishart_1.1.2.1</span></span>
<span><span class="co">#&gt; [34] lifecycle_1.0.4     vctrs_0.6.5         evaluate_1.0.0     </span></span>
<span><span class="co">#&gt; [37] glue_1.7.0          farver_2.1.2        ragg_1.3.3         </span></span>
<span><span class="co">#&gt; [40] fansi_1.0.6         colorspace_2.1-1    rmarkdown_2.28     </span></span>
<span><span class="co">#&gt; [43] tools_4.4.1         pkgconfig_2.0.3     htmltools_0.5.8.1</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="all-the-code-for-easy-copying">All the code for easy copying<a class="anchor" aria-label="anchor" href="#all-the-code-for-easy-copying"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span></span>
<span>  collapse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comment <span class="op">=</span> <span class="st">"#&gt;"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20190622</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">7</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/rWishart.html" class="external-link">rWishart</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">A</span> <span class="op">=</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">100</span>,mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">100</span>,<span class="fl">0</span>,<span class="fl">25</span>,<span class="op">-</span><span class="fl">1000</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>   V <span class="op">=</span> <span class="va">sigma</span>, df <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">results</span><span class="op">=</span><span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="va">A</span>, df <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">### Here is the long simulation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20181102</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">df5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df550</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df1050</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df2050</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df5100</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df10100</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">df20100</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meanmat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">U</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">V</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">df5</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">5</span>, n <span class="op">=</span> <span class="fl">35</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df10</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">35</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df100</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">20</span>, n <span class="op">=</span> <span class="fl">35</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df550</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">5</span>, n <span class="op">=</span> <span class="fl">50</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df1050</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">50</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df2050</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">20</span>, n <span class="op">=</span> <span class="fl">50</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df5100</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">5</span>, n <span class="op">=</span> <span class="fl">100</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df10100</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">100</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span>    <span class="va">df20100</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">meanmat</span>,</span>
<span>        df <span class="op">=</span> <span class="fl">20</span>, n <span class="op">=</span> <span class="fl">100</span>, U <span class="op">=</span><span class="va">U</span>, V <span class="op">=</span><span class="va">V</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">truedataframe</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>truedf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>, </span>
<span>                                           label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5 df'</span>, <span class="st">'10 df'</span>, <span class="st">'20 df'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                           estdf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dfdataframe</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>truedf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span>, </span>
<span>                                         label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'5 df'</span>, <span class="st">'10 df'</span>, <span class="st">'20 df'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                         estdf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df5</span>, <span class="va">df10</span>, <span class="va">df100</span>, <span class="va">df550</span>, <span class="va">df1050</span>, <span class="va">df2050</span>, <span class="va">df5100</span>, <span class="va">df10100</span>, <span class="va">df20100</span><span class="op">)</span>,</span>
<span>                         samplesize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">600</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">denseplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dfdataframe</span>, <span class="va">estdf</span> <span class="op">&lt;</span> <span class="fl">200</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">estdf</span>, fill<span class="op">=</span><span class="va">samplesize</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">truedataframe</span>,</span>
<span>               mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">estdf</span><span class="op">)</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.ticks.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>          strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, </span>
<span>          legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.95</span>,<span class="fl">.4</span><span class="op">)</span>,</span>
<span>          legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          legend.text <span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density plot of estimated degrees of freedom compared to actual"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>     </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#050505"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span><span class="op">)</span>, </span>
<span>        name <span class="op">=</span> <span class="st">"Sample Size"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">truedf</span><span class="op">)</span><span class="op">~</span><span class="va">.</span>,  scales<span class="op">=</span><span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="cn">NULL</span></span>
<span><span class="va">denseplot</span></span>
<span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dfdataframe</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">truedf</span>, <span class="va">samplesize</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>, max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>,</span>
<span>    mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">### Here ends the long simulation</span></span>
<span></span>
<span><span class="co">##### Here is what is really run</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20190621</span><span class="op">)</span></span>
<span><span class="va">df10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">df1050</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">df10100</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">df10</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span>,df <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span>, df <span class="op">=</span> <span class="fl">5</span>, max.iter <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span><span class="op">)</span></span>
<span>   <span class="va">df1050</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span>,df <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span>, df <span class="op">=</span> <span class="fl">5</span>, max.iter <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span><span class="op">)</span></span>
<span>   <span class="va">df10100</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/MLmatrixt.html">MLmatrixt</a></span><span class="op">(</span><span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span>,<span class="fl">3</span><span class="op">)</span>,df <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">FALSE</span>, df <span class="op">=</span> <span class="fl">5</span>, max.iter <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">$</span><span class="va">nu</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">dfdataframe</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'10 df'</span><span class="op">)</span>,</span>
<span>                         estdf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">df10</span>, <span class="va">df1050</span>, <span class="va">df10100</span><span class="op">)</span>,</span>
<span>                         samplesize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="va">denseplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dfdataframe</span>, <span class="va">estdf</span> <span class="op">&lt;</span> <span class="fl">200</span><span class="op">)</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">estdf</span>, fill<span class="op">=</span><span class="va">samplesize</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>               size <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.ticks.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, axis.text.y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, </span>
<span>          legend.justification<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, legend.position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.95</span>,<span class="fl">.4</span><span class="op">)</span>,</span>
<span>          legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>          legend.text <span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Density plot of estimated degrees of freedom compared to actual"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span>     </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#050505"</span>, <span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Sample Size"</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="co">#   facet_wrap(factor(truedf)~.,  scales="free") +</span></span>
<span>    <span class="cn">NULL</span></span>
<span><span class="va">denseplot</span></span>
<span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">dfdataframe</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">samplesize</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>, max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>,</span>
<span>    median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>,</span>
<span>    mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">estdf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#### Here ends what is really run</span></span>
<span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">C</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmatrixt.html">rmatrixt</a></span><span class="op">(</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">2</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span>, df <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">ABC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">A</span>,<span class="va">B</span>,<span class="va">C</span><span class="op">)</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"B"</span>,<span class="fl">30</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"C"</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">30</span>,<span class="fl">30</span><span class="op">)</span><span class="op">/</span><span class="fl">90</span></span>
<span><span class="va">matlda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/matrixlda.html">matrixlda</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ABC</span>,grouping <span class="op">=</span> <span class="va">groups</span>, prior <span class="op">=</span> <span class="va">prior</span>,</span>
<span>                    method <span class="op">=</span> <span class="st">'t'</span>, nu <span class="op">=</span> <span class="fl">10</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">matlda</span>, newdata <span class="op">=</span> <span class="va">ABC</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">31</span>,<span class="fl">61</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-dickey1967" class="csl-entry">
Dickey, James M. 1967. <span>‚ÄúMatricvariate Generalizations of the
Multivariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
Distribution and the Inverted Multivariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
Distribution.‚Äù</span> <em>Ann. Math. Statist.</em> 38 (2): 511‚Äì18. <a href="https://doi.org/10.1214/aoms/1177698967" class="external-link">https://doi.org/10.1214/aoms/1177698967</a>.
</div>
<div id="ref-liurubin1994" class="csl-entry">
Liu, Chuanhai, and Donald B. Rubin. 1994. <span>‚ÄúThe <span>ECME</span>
Algorithm: A Simple Extension of <span>EM</span> and <span>ECM</span>
with Faster Monotone Convergence.‚Äù</span> <em>Biometrika</em> 81 (4):
633‚Äì48. <a href="https://doi.org/10.2307/2337067" class="external-link">https://doi.org/10.2307/2337067</a>.
</div>
<div id="ref-meng1993" class="csl-entry">
Meng, Xiao-Li, and Donald B. Rubin. 1993. <span>‚ÄúMaximum Likelihood
Estimation via the <span>ECM</span> Algorithm: A General
Framework.‚Äù</span> <em>Biometrika</em> 80 (2): 267‚Äì78. <a href="https://doi.org/10.1093/biomet/80.2.267" class="external-link">https://doi.org/10.1093/biomet/80.2.267</a>.
</div>
<div id="ref-rubin1983" class="csl-entry">
Rubin, D. B. 1983. <span>‚ÄúEncyclopedia of Statistical Sciences.‚Äù</span>
In, 4th ed., 272‚Äì75. John Wiley.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
